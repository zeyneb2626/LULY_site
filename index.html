<!DOCTYPE html>
<html lang="fr">
<head>
  <meta charset="UTF-8">
  <title>Configurateur Tradi'home</title>
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <!-- model-viewer pour charger le GLB local -->
  <script type="module"
    src="https://unpkg.com/@google/model-viewer/dist/model-viewer.min.js"></script>
  <style>
    body { margin:0; padding:0; font-family:-apple-system,BlinkMacSystemFont,sans-serif; color:#333; }
    #configurator { display:flex; flex-wrap:wrap; gap:2rem; max-width:1200px; margin:2rem auto 1rem; }
    .viewer { flex:2; display:flex; flex-direction:column; gap:1rem; }
    model-viewer { width:100%; height:480px; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.1); }
    #features { display:flex; justify-content:space-between; gap:1rem; margin-top:-1rem; }
    .feature-box { flex:1; background:#fafafa; padding:.8rem; border-radius:6px; text-align:center;
                   box-shadow:0 1px 4px rgba(0,0,0,0.05); }
    .feature-box h3 { margin:0; font-size:1.1rem; font-weight:600; }
    .feature-box p  { margin:.2rem 0 0; font-size:.85rem; color:#666; }

    .controls { flex:1; display:flex; flex-direction:column; gap:1.2rem;
                padding:1rem; background:#fff; border-radius:8px;
                box-shadow:0 2px 8px rgba(0,0,0,0.05); }
    .controls h2 { margin:0; font-size:1.25rem; }
    .controls .description { margin:0; font-size:.95rem; color:#555; }

    .options-list { display:flex; flex-wrap:wrap; gap:1rem; margin-top:1rem; }
    .option {
      width:4.5rem; height:4.5rem;
      border:2px solid #ddd; border-radius:6px;
      display:flex; flex-direction:column; justify-content:flex-end; align-items:center;
      padding-bottom:1rem; box-sizing:border-box; position:relative;
      cursor:pointer;
    }
    .option .label, .option .price {
      display:block; text-align:center; color:#000; font-weight:600; white-space:nowrap;
    }
    .option .label { font-size:.75rem; margin-top:.3rem; }
    .option .price { font-size:.7rem; margin-top:.1rem; }
    .option.selected { border-color:#0066ff; box-shadow:0 0 0 3px rgba(0,102,255,0.2); }
    .option.selected::after {
      content:'✓'; position:absolute; top:4px; right:4px;
      background:#0066ff; color:#fff; width:.9rem; height:.9rem; font-size:.65rem;
      border-radius:50%; display:flex; align-items:center; justify-content:center;
    }

    #price-summary { max-width:1200px; margin:1rem auto 2rem; background:#fff;
                     padding:1rem; border-radius:8px; box-shadow:0 2px 8px rgba(0,0,0,0.05);
                     font-size:.9rem; }
    #price-summary .row { display:flex; justify-content:space-between; margin-bottom:.6rem; }
    #price-summary .divider { height:1px; background:#ddd; margin:.5rem 0; }
    #price-summary .total { font-weight:600; font-size:1.1rem; }
    #price-summary .disclaimer { margin-top:.6rem; font-size:.75rem; color:#777; line-height:1.3; }
    .btn-secondary, .btn-primary {
      display:block; width:100%; padding:.7rem; margin-top:.8rem;
      border:none; border-radius:6px; font-size:.95rem; cursor:pointer;
    }
    .btn-secondary { background:#fff; color:#333; border:1px solid #ccc; }
    .btn-primary   { background:#0066ff; color:#fff; }

    @media (max-width:768px) {
      #configurator { flex-direction:column; margin:1rem; }
      model-viewer { height:300px; }
      .controls { width:100%; padding:.8rem; }
      .options-list { gap:.6rem; }
      .option { width:4rem; height:4rem; padding-bottom:.8rem; }
      .option .label { font-size:.7rem; }
      .option .price { font-size:.65rem; }
      #features { flex-direction:column; gap:.8rem; }
    }
  </style>
</head>
<body>

<div id="configurator">
  <div class="viewer">
    <!-- Affiche ton GLB local -->
    <model-viewer id="model"
      src="assets/models/Tradi_home_draco.glb"
      camera-controls auto-rotate ar
      background-color="#ffffff">
    </model-viewer>

    <div id="features">
      <div class="feature-box"><h3>85 m²</h3><p>Surface</p></div>
      <div class="feature-box"><h3>3 Ch</h3><p>Chambres</p></div>
      <div class="feature-box"><h3>2 SdE</h3><p>Salles d’eau</p></div>
    </div>
  </div>

  <div class="controls">
    <h2>Configuration Tradi'home</h2>
    <p class="description">Personnalisez votre maison selon vos préférences</p>

    <!-- Répète ce bloc .options-list pour chaque groupe d’options -->
    <div class="options-list">
      <span class="option selected" data-group="mur" data-value="b" style="background:#fff">
        <span class="price">Inclus</span>
        <span class="label">Blanc</span>
      </span>
      <span class="option" data-group="mur" data-value="be" style="background:#CCC0AF">
        <span class="price">+399 €</span>
        <span class="label">Beige Ares</span>
      </span>
      <span class="option" data-group="mur" data-value="o" style="background:#E6C7B1">
        <span class="price">+1 499 €</span>
        <span class="label">Ocre Mojave</span>
      </span>
    </div>
    <!-- Bardage -->
    <div class="options-list">
      <span class="option selected" data-group="bardage" data-value="cc" style="background:#C19A6B">
        <span class="price">+520 €</span>
        <span class="label">Chêne clair</span>
      </span>
      <span class="option" data-group="bardage" data-value="cf" style="background:#8B5A2B">
        <span class="price">+790 €</span>
        <span class="label">Chêne foncé</span>
      </span>
      <span class="option" data-group="bardage" data-value="co" style="background:#3D4C5C">
        <span class="price">+895 €</span>
        <span class="label">Gris oragé</span>
      </span>
    </div>
    <!-- Menuiserie -->
    <div class="options-list">
      <span class="option selected" data-group="menuiserie" data-value="b" style="background:#fff">
        <span class="price">Inclus</span>
        <span class="label">Blanc</span>
      </span>
      <span class="option" data-group="menuiserie" data-value="g" style="background:#293133">
        <span class="price">+1 480 €</span>
        <span class="label">Anthracite</span>
      </span>
    </div>
    <!-- Pergola -->
    <div class="options-list">
      <span class="option selected" data-group="pergola" data-value="b" style="background:#fff">
        <span class="price">Inclus</span>
        <span class="label">Aucune</span>
      </span>
      <span class="option" data-group="pergola" data-value="g" style="background:#293133">
        <span class="price">+3 500 €</span>
        <span class="label">Anthracite</span>
      </span>
    </div>
    <!-- Toiture -->
    <div class="options-list">
      <span class="option selected" data-group="toit" data-value="bl" style="background:#133654">
        <span class="price">Inclus</span>
        <span class="label">Bleu Ardoise</span>
      </span>
      <span class="option" data-group="toit" data-value="g" style="background:#777">
        <span class="price">Inclus</span>
        <span class="label">Gris Acier</span>
      </span>
      <span class="option" data-group="toit" data-value="r" style="background:#CC3333">
        <span class="price">+1 500 €</span>
        <span class="label">Rouge Hibiscus</span>
      </span>
    </div>
  </div>
</div>

<div id="price-summary">
  <div class="row"><span>Prix de base</span><span id="base-price">170 000 €</span></div>
  <div class="row"><span>Vos options</span><span id="options-sum">0 €</span></div>
  <div class="divider"></div>
  <div class="row total"><span>Total TTC</span><span id="total-sum">170 000 €</span></div>
  <p class="disclaimer">Simulation non contractuelle – coût variable selon terrain.</p>
  <button class="btn-secondary">Enregistrer la configuration</button>
  <button class="btn-primary">Demander un devis</button>
</div>

<script>
  // --- Données de base ---
  const basePrice = 170000;
  const optionPrices = {
    mur:        { b:0,    be:399,   o:1499 },
    bardage:    { cc:520, cf:790,   co:895 },
    menuiserie: { b:0,    g:1480 },
    pergola:    { b:0,    g:3500 },
    toit:       { bl:0,   g:0,      r:1500 }
  };
  // choix initiaux
  const selections = { mur:'b', bardage:'cc', menuiserie:'b', pergola:'b', toit:'bl' };

  // modèle GLB :  
  // assets/models/Tradi_home_draco.glb
  function loadModel(){
    const key = [selections.mur,selections.bardage,selections.menuiserie,selections.pergola,selections.toit].join('_');
    // si tu compresses chaque fichier GLB en Draco, il faut ici un modelMap similaire à celui qu’on avait avec Sketchfab.
    // Sinon, tu peux réexporter un seul GLB avec des material-variants et piloter les variantes via model-viewer.
  }

  function updatePrice(){
    let sum=0;
    for(let g in optionPrices) sum+=optionPrices[g][selections[g]];
    document.getElementById('options-sum').textContent = sum.toLocaleString('fr-FR') + ' €';
    document.getElementById('total-sum') .textContent = (basePrice+sum).toLocaleString('fr-FR') + ' €';
  }

  document.querySelectorAll('.option').forEach(el=>{
    const grp=el.dataset.group, val=el.dataset.value;
    if(selections[grp]===val) el.classList.add('selected');
    el.addEventListener('click',()=>{
      document.querySelectorAll(`.option[data-group="${grp}"]`).forEach(x=>x.classList.remove('selected'));
      el.classList.add('selected');
      selections[grp]=val;
      loadModel();
      updatePrice();
    });
  });

  // initialisation prix
  updatePrice();
</script>

</body>
</html>
